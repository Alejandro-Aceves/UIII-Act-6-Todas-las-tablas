{% extends 'app_instrumental/base.html' %}

{% block title %}{% if detalle %}Editar{% else %}Nuevo{% endif %} Detalle de Venta{% endblock %}

{% block content %}
<h1>{% if detalle %}Editar{% else %}Nuevo{% endif %} Detalle de Venta</h1>

<form method="post">
    {% csrf_token %}
    
    <div class="form-group">
        <label for="id_venta">Venta:</label>
        <select id="id_venta" name="id_venta" required>
            <option value="">Seleccione una venta</option>
            {% for venta in ventas %}
            <option value="{{ venta.id_venta }}" {% if detalle.id_venta.id_venta == venta.id_venta %}selected{% endif %}>
                Venta #{{ venta.id_venta }} - Total: ${{ venta.total }} - {{ venta.get_estado_display }}
            </option>
            {% endfor %}
        </select>
    </div>
    
    <div class="form-group">
        <label for="id_instrumento">Instrumento:</label>
        <select id="id_instrumento" name="id_instrumento" required>
            <option value="">Seleccione un instrumento</option>
            {% for instrumento in instrumentos %}
            <option value="{{ instrumento.id_instrumento }}" {% if detalle.id_instrumento.id_instrumento == instrumento.id_instrumento %}selected{% endif %}>
                {{ instrumento.nombre }} - {{ instrumento.marca }} ({{ instrumento.modelo }})
            </option>
            {% endfor %}
        </select>
    </div>
    
    <div class="form-group">
        <label for="cantidad">Cantidad:</label>
        <input type="number" id="cantidad" name="cantidad" value="{{ detalle.cantidad|default:'' }}" required>
    </div>
    
    <div class="form-group">
        <label for="precio_unitario">Precio Unitario:</label>
        <input type="number" step="0.01" id="precio_unitario" name="precio_unitario" value="{{ detalle.precio_unitario|default:'' }}" required>
    </div>
    
    <div class="form-group">
        <label for="descuento_linea">Descuento:</label>
        <input type="number" step="0.01" id="descuento_linea" name="descuento_linea" value="{{ detalle.descuento_linea|default:'0' }}">
    </div>
    
    <div class="form-group">
        <label for="subtotal">Subtotal:</label>
        <input type="number" step="0.01" id="subtotal" name="subtotal" value="{{ detalle.subtotal|default:'' }}" required>
    </div>
    
    <div class="form-group">
        <label for="notas">Notas:</label>
        <textarea id="notas" name="notas" rows="3">{{ detalle.notas|default:'' }}</textarea>
    </div>
    
    <button type="submit" class="btn btn-primary">Guardar</button>
    <a href="{% url 'detalles_venta_list' %}" class="btn btn-danger">Cancelar</a>
</form>
{% endblock %}