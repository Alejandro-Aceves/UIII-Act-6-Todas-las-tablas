{% extends 'app_instrumental/base.html' %}

{% block title %}{% if venta %}Editar{% else %}Nueva{% endif %} Venta{% endblock %}

{% block content %}
<h1>{% if venta %}Editar{% else %}Nueva{% endif %} Venta</h1>

<form method="post">
    {% csrf_token %}
    
    <div class="form-group">
        <label for="id_empleado">Empleado:</label>
        <select id="id_empleado" name="id_empleado">
            <option value="">Sin asignar</option>
            {% for empleado in empleados %}
            <option value="{{ empleado.id_empleado }}" {% if venta.id_empleado.id_empleado == empleado.id_empleado %}selected{% endif %}>
                {{ empleado.nombre }} - {{ empleado.puesto }}
            </option>
            {% endfor %}
        </select>
    </div>
    
    <div class="form-group">
        <label for="id_cliente">Cliente:</label>
        <select id="id_cliente" name="id_cliente">
            <option value="">Sin asignar</option>
            {% for cliente in clientes %}
            <option value="{{ cliente.id }}" {% if venta.id_cliente.id == cliente.id %}selected{% endif %}>
                {{ cliente.nombre }} - {{ cliente.email }}
            </option>
            {% endfor %}
        </select>
    </div>
    
    <div class="form-group">
        <label for="subtotal">Subtotal:</label>
        <input type="number" step="0.01" id="subtotal" name="subtotal" value="{{ venta.subtotal|default:'' }}" required>
    </div>
    
    <div class="form-group">
        <label for="descuento">Descuento:</label>
        <input type="number" step="0.01" id="descuento" name="descuento" value="{{ venta.descuento|default:'0' }}">
    </div>
    
    <div class="form-group">
        <label for="impuesto">Impuesto:</label>
        <input type="number" step="0.01" id="impuesto" name="impuesto" value="{{ venta.impuesto|default:'0' }}">
    </div>
    
    <div class="form-group">
        <label for="total">Total:</label>
        <input type="number" step="0.01" id="total" name="total" value="{{ venta.total|default:'' }}" required>
    </div>
    
    <div class="form-group">
        <label for="estado">Estado:</label>
        <select id="estado" name="estado" required>
            {% for key, value in estados %}
            <option value="{{ key }}" {% if venta.estado == key %}selected{% endif %}>{{ value }}</option>
            {% endfor %}
        </select>
    </div>
    
    <button type="submit" class="btn btn-primary">Guardar</button>
    <a href="{% url 'ventas_list' %}" class="btn btn-danger">Cancelar</a>
</form>
{% endblock %}